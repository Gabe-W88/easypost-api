# Make.com Google Sheets Quick Reference

## Why Available Values Don't Match Spreadsheet Columns

**Common Issue:** Make.com's "Add a Row" module reads column headers from your Google Sheet to determine available fields. If the headers don't match what you expect, here's how to fix it:

### Solution Steps:

1. **Refresh the Module:**
   - In Make.com, click on your "Google Sheets" module
   - Click the circular refresh icon (↻) next to "Table contains headers"
   - This forces Make.com to re-read the spreadsheet headers

2. **Verify Headers:**
   - Open your Google Sheet
   - Ensure row 1 contains all column headers
   - Headers should match exactly (case-sensitive)
   - No extra spaces or special characters

3. **Check "Table contains headers" Setting:**
   - Must be set to **"Yes"**
   - If set to "No", Make.com won't read headers and will use generic field names

4. **Reconnect if Needed:**
   - Sometimes disconnecting and reconnecting the Google Sheets connection helps
   - Go to module settings → Connection → Disconnect → Reconnect

---

## Quick Field Mapping Cheat Sheet

Copy-paste these directly into Make.com's field mapping:

### Basic Info
| Column | Make.com Field Path |
|--------|---------------------|
| Application # | `{{application_id}}` |
| Date and time submitted | `{{formatDate(timestamps.created_at; "MM/DD/YYYY HH:mm:ss")}}` |
| Email address | `{{customer.email}}` |
| Phone number | `{{customer.phone}}` |
| First name | `{{customer.first_name}}` |
| Middle name | `{{customer.middle_name}}` |
| Last name | `{{customer.last_name}}` |
| Date of birth | `{{customer.date_of_birth}}` |

### License Info
| Column | Make.com Field Path |
|--------|---------------------|
| Driver's License Number | `{{license_info.license_number}}` |
| State of Issue | `{{license_info.license_state}}` |
| License Expiration Date | `{{license_info.license_expiration}}` |
| Street Address (License) | `{{form_address.street_address}}` |
| Street Address 2 (License) | `{{form_address.street_address_2}}` |
| City (License) | `{{form_address.city}}` |
| State (License) | `{{form_address.state}}` |
| Zip Code (License) | `{{form_address.zip_code}}` |

### Endorsements (Y/N)
| Column | Make.com Formula |
|--------|------------------|
| Passenger Car Endorsement? | `{{if(contains(selections.license_types; "passenger"); "Y"; "N")}}` |
| Motorcycle Endorsement? | `{{if(contains(selections.license_types; "motorcycle"); "Y"; "N")}}` |
| Commercial/Other Endorsement? | `{{if(or(contains(selections.license_types; "commercial"); contains(selections.license_types; "other")); "Y"; "N")}}` |

### Travel Info
| Column | Make.com Field Path |
|--------|---------------------|
| Brithplace City | `{{license_info.birthplace_city}}` |
| Brithplace State/Country | `{{license_info.birthplace_state}}` |
| Where will you drive abroad | `{{travel_info.drive_abroad}}` |
| Departure date from USA | `{{travel_info.departure_date}}` |
| Permit Effective Date | `{{travel_info.permit_effective_date}}` |

### Permits (Y/N)
| Column | Make.com Formula |
|--------|------------------|
| Getting an IDP (Y/N) | `{{if(contains(selections.selected_permits; "idp"); "Y"; "N")}}` |
| Getting an IADP (Y/N) | `{{if(contains(selections.selected_permits; "iadp"); "Y"; "N")}}` |

### Shipping Info
| Column | Make.com Field Path (Conditional) |
|--------|----------------------------------|
| Delivery location type | `{{capitalize(selections.shipping_category)}}` |
| Delivery speed | `{{capitalize(selections.delivery_speed)}}` |
| Transaction value ($) | `{{formatNumber(amount_total; 2)}}` |
| Shipping label autogenerated | `{{if(equals(fulfillment_type; "automated"); "y"; "n")}}` |

### Shipping Address (Use Conditional Logic)

**For Domestic/Military:**
- Recipient Name: `{{if(equals(selections.shipping_category; "domestic"); shipping_address_form_fields.recipient_name; if(equals(selections.shipping_category; "military"); shipping_address_form_fields.recipient_name; shipping_address.name))}}`
- Street Address: `{{if(equals(selections.shipping_category; "domestic"); shipping_address_form_fields.street_address; if(equals(selections.shipping_category; "military"); shipping_address_form_fields.street_address; shipping_address.line1))}}`
- City: `{{if(equals(selections.shipping_category; "domestic"); shipping_address_form_fields.city; if(equals(selections.shipping_category; "military"); shipping_address_form_fields.city; shipping_address.city))}}`
- State: `{{if(equals(selections.shipping_category; "domestic"); shipping_address_form_fields.state; if(equals(selections.shipping_category; "military"); shipping_address_form_fields.state; shipping_address.state))}}`
- Postal Code: `{{if(equals(selections.shipping_category; "domestic"); shipping_address_form_fields.postal_code; if(equals(selections.shipping_category; "military"); shipping_address_form_fields.postal_code; shipping_address.postal_code))}}`
- Country: `{{if(equals(selections.shipping_category; "domestic"); shipping_address_form_fields.country; if(equals(selections.shipping_category; "military"); shipping_address_form_fields.country; shipping_address.country))}}`

**Simpler Alternative (Use Default Value):**
- Use `{{shipping_address.name}}` or `{{shipping_address_form_fields.recipient_name}}` - Make.com will use whichever exists
- Use `{{default(shipping_address_form_fields.street_address; shipping_address.line1)}}` for street address

---

## Step-by-Step Setup in Make.com

### 1. Add Webhook Module
- Add "Webhook" → "Custom webhook"
- Copy the webhook URL
- Save the scenario

### 2. Add Google Sheets Module
- Add "Google Sheets" → "Add a Row"
- Connect to Google account
- Select: "Fast IDP Submissions Tracker - Dec 2025"
- Select sheet: "Sheet1"
- Set "Table contains headers" to **"Yes"**
- Click the refresh icon (↻) to reload headers

### 3. Map Fields
For each field in the "Values" section:

1. Click the field name (e.g., "Application # (A)")
2. Click the mapping icon `</>` or `{}`
3. Enter the webhook path from the table above
4. For formulas (Y/N fields), enter the full formula

### 4. Test
- Run the scenario manually with test data
- Check the Google Sheet to verify data appears correctly
- Adjust mappings as needed

---

## Common Make.com Functions Used

### `if()` - Conditional Logic
```
if(condition; "value if true"; "value if false")
```

### `contains()` - Check Array Membership
```
contains(array; "value")
```

### `formatDate()` - Format Dates
```
formatDate(date; "MM/DD/YYYY HH:mm:ss")
```

### `formatNumber()` - Format Numbers
```
formatNumber(number; 2)  // 2 decimal places
```

### `capitalize()` - Capitalize First Letter
```
capitalize("domestic")  // Returns "Domestic"
```

### `default()` - Use Fallback Value
```
default(value1; value2)  // Returns value1 if exists, else value2
```

### `equals()` - Check Equality
```
equals(value1; "value2")
```

### `or()` - Logical OR
```
or(condition1; condition2)
```

---

## Troubleshooting

### Problem: Fields show as "undefined" or empty
**Solution:** Check the webhook payload structure. Use Make.com's "Data Store" or "Set Variable" module to inspect the webhook data structure.

### Problem: Array fields not working
**Solution:** Use `contains()` function to check array membership, not direct comparison.

### Problem: Date format wrong
**Solution:** Use `formatDate()` function with desired format string.

### Problem: Shipping address empty for international
**Solution:** Check if `shipping_address` object exists. For international, use `shipping_address.line1` instead of `shipping_address_form_fields.street_address`.

### Problem: Make.com can't find spreadsheet
**Solution:** 
1. Ensure you have edit access to the Google Sheet
2. Check the spreadsheet ID is correct
3. Try disconnecting and reconnecting Google Sheets connection

---

## Testing Checklist

- [ ] Webhook receives data correctly
- [ ] All basic info fields map correctly
- [ ] License info fields map correctly
- [ ] Endorsement Y/N fields work correctly
- [ ] Travel info fields map correctly
- [ ] Permit Y/N fields work correctly
- [ ] Shipping category and speed map correctly
- [ ] Transaction value formats correctly
- [ ] Shipping address maps correctly for domestic
- [ ] Shipping address maps correctly for international
- [ ] Shipping address maps correctly for military
- [ ] Date fields format correctly
- [ ] Empty/missing fields don't cause errors

---

**Last Updated:** Current Session  
**Status:** Ready for Make.com configuration

