# Final Verification: Form → Supabase Mapping

## ✅ Complete Mapping Check

### CSV Column → Supabase Column → Code Mapping

| CSV Column | Supabase Column | Code Field | Status |
|------------|----------------|------------|--------|
| Application # | `application_id` | `applicationId` | ✅ Saved |
| Date and time submitted | `created_at` | Auto-generated | ✅ Auto |
| Email address | `email` | `formData.email` | ✅ Saved |
| Phone number | `phone` | `formData.phone` | ✅ Saved |
| First name | `first_name` | `formData.firstName` | ✅ Saved |
| Middle name | `middle_name` | `formData.middleName` | ✅ Saved |
| Last name | `last_name` | `formData.lastName` | ✅ Saved |
| Date of birth | `date_of_birth` | `formData.dateOfBirth` | ✅ Saved |
| Driver's License Number | `license_number` | `formData.licenseNumber` | ✅ Saved |
| State of Issue | `license_state` | `formData.licenseState` | ✅ Saved |
| License Expiration Date | `license_expiration` | `formData.licenseExpiration` | ✅ Saved |
| Street Address (License) | `street_address` | `formData.streetAddress` | ✅ Saved |
| Street Address 2 | `street_address_2` | `formData.streetAddress2` | ✅ Saved |
| City (License) | `city` | `formData.city` | ✅ Saved |
| State (License) | `state` | `formData.state` | ✅ Saved |
| Zip Code (License) | `zip_code` | `formData.zipCode` | ✅ Saved |
| Passenger Car Endorsement? | `license_types` JSONB | Query: contains 'passenger' | ✅ Saved |
| Motorcycle Endorsement? | `license_types` JSONB | Query: contains 'motorcycle' | ✅ Saved |
| Commercial/Other Endorsement? | `license_types` JSONB | Query: contains 'commercial'/'other' | ✅ Saved |
| Brithplace City | `birthplace_city` | `formData.birthplaceCity` | ✅ Saved |
| Brithplace State/Country | `birthplace_state` | `formData.birthplaceState` | ✅ Saved |
| Where will you drive abroad | `drive_abroad` | `formData.driveAbroad` | ✅ Saved |
| Departure date from USA | `departure_date` | `formData.departureDate` | ✅ Saved |
| Permit Effective Date | `permit_effective_date` | `formData.permitEffectiveDate` | ✅ Saved |
| Getting an IDP (Y/N) | `selected_permits` JSONB | Query: contains 'idp' | ✅ Saved |
| Getting an IADP (Y/N) | `selected_permits` JSONB | Query: contains 'iadp' | ✅ Saved |
| **Shipping Recipient Name** | `shipping_recipient_name` | `formData.recipientName` | ✅ Saved |
| **Shipping Recipient Phone** | `shipping_recipient_phone` | `formData.recipientPhone` | ✅ Saved |
| **Shipping Street Address** | `shipping_street_address` | `formData.shippingStreetAddress` | ✅ Saved |
| **Shipping Street Address 2** | `shipping_street_address_2` | `formData.shippingStreetAddress2` | ✅ Saved |
| **Shipping City** | `shipping_city` | `formData.shippingCity` | ✅ Saved |
| **Shipping State** | `shipping_state` | `formData.shippingState` | ✅ Saved |
| **Shipping Postal Code** | `shipping_postal_code` | `formData.shippingPostalCode` | ✅ Saved |
| **Shipping Country** | `shipping_country` | Normalized from `formData.shippingCountry` | ✅ Saved |
| **Delivery Instructions** | `shipping_delivery_instructions` | `formData.shippingDeliveryInstructions` | ✅ Saved |
| **International Full Address** | `international_full_address` | `formData.internationalFullAddress` | ✅ Saved |
| **International Local Address** | `international_local_address` | `formData.internationalLocalAddress` | ✅ Saved |
| **PCCC Code** | `pccc_code` | `formData.pcccCode` | ✅ Saved |
| Delivery location type | `shipping_category` | `formData.shippingCategory` | ✅ Saved |
| Delivery speed | `processing_option` | `formData.processingOption` | ✅ Saved |
| Transaction value ($) | `amount_paid` | Set in `webhook.js` | ✅ Saved |
| Shipping label autogenerated | `shipping_label_generated` | `fulfillmentType === 'automated'` | ✅ Saved |
| Automatic Tracking No. | `tracking_number` | Updated later | ✅ Column exists |
| Ship by date | `ship_by_date` | Calculated from `processingOption` | ✅ Saved |

## ✅ All Fields Mapped

**Every CSV column has a corresponding Supabase column that gets populated automatically.**

### What Gets Saved When:
- **On Form Submit (save-application.js):** All form fields, shipping info, processing options
- **On Payment Complete (webhook.js):** `amount_paid`, payment status, billing/shipping from Stripe

### How to Query Y/N Fields:
```sql
-- Passenger Car Endorsement
CASE WHEN license_types @> '["passenger"]'::jsonb THEN 'Y' ELSE 'N' END

-- Getting an IDP
CASE WHEN selected_permits @> '["idp"]'::jsonb THEN 'Y' ELSE 'N' END
```

## ✅ Ready to Go

Everything is mapped. Run the clean start SQL and test!

